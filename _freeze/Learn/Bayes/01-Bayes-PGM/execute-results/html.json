{
  "hash": "c98e33dccd59e3a172e2bf88abb3c959",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"贝叶斯与概率图模型（PGM）\"\nauthor: \"Simonzhou\"\ndate: \"2025-02-28\"\nformat: \n  html:           # 输出格式为 HTML\n    self-contained: true  # 生成独立的 HTML 文件\n#  pdf:            # 可选：如果需要 PDF 输出\n#    default\nexecute:\n  echo: true      # 在输出中显示代码\n  eval: true      # 执行代码\n  warning: false  # 隐藏警告信息\n  message: false  # 隐藏消息\n---\n\n\n\n\n# 概率图模型（Probabilistic Graphical Models）\n\n概率图模型是一种结合概率论与图论的理论框架，用于表示和分析复杂系统中的不确定性及概率关系。\n\n## 常见类型\n\n-   贝叶斯网络\n\n-   马尔科夫随机场（MRF)\n\n-   隐马尔科夫模型（HMM)\n\n## 用R来展示概率图模型\n\n### 使用R程序包`gRain`。\n\n安装：\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"gRain\")\n```\n:::\n\n\n\n\n加载：\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"gRbase\")\n```\n:::\n\n\n\n\n首先定义一个带有变量的A、B、C、D、E的简单无向图\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph <- ug(\"A:B:E + C:E:D\")\nclass(graph)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"igraph\"\n```\n\n\n:::\n:::\n\n\n\n\n安装可视化程序包，使用流行的`Rgraphviz`\n\n`Rgraphviz`是 Bioconductor 生态系统的一部分，所以可以通过 Bioconductor 来安装它。首先要确保已经安装了`BiocManager`，若未安装，可使用以下代码进行安装：\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(\"BiocManager\", quietly = TRUE))\n    install.packages(\"BiocManager\")\n```\n:::\n\n\n\n\n安装好`BiocManager`之后，使用它来安装`Rgraphviz`：\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBiocManager::install(\"Rgraphviz\")\n```\n:::\n\n\n\n\n载入并使用：\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"Rgraphviz\")\nplot(graph)\n```\n\n::: {.cell-output-display}\n![](01-Bayes-PGM_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n定义有向图：\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag <- dag(\"A + B:A + C:B + D:B + E:C:D\")\ndag\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIGRAPH 28898ca DN-- 1 0 -- \n+ attr: name (v/c)\n+ edges from 28898ca (vertex names):\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(dag)\n```\n\n::: {.cell-output-display}\n![](01-Bayes-PGM_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n## 报错\n\n报错：无法正确显示图形\n\n原因：`Rgraphviz` 没有被正确的安装。\n\n需要从bioconductor中安装：\n\n\n\n\n::: {.cell}\n\n```{.bash .cell-code}\n> install.packages(\"Rgraphviz\")\nInstalling package into 'C:/Users/asus/AppData/Local/R/win-library/4.4'\n(as 'lib' is unspecified)\nWarning message:\npackage 'Rgraphviz' is not available for this version of R\n\nA version of this package for your version of R might be available elsewhere,\nsee the ideas at\nhttps://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages\n```\n:::\n\n\n\n\n当使用 `bidconductor` 源来安装 `Rgraphviz` ，首先安装 `BiocManager` ：\n\n\n\n\n::: {.cell}\n\n```{.bash .cell-code}\n> if (!require(\"BiocManager\", quietly = TRUE))\n+     install.packages(\"BiocManager\")\nInstalling package into 'C:/Users/asus/AppData/Local/R/win-library/4.4'\n(as 'lib' is unspecified)\ntrying URL 'https://mirrors.sustech.edu.cn/CRAN/bin/windows/contrib/4.4/BiocManager_1.30.25.zip'\nContent type 'application/zip' length 506482 bytes (494 KB)\ndownloaded 494 KB\n\npackage 'BiocManager' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n        C:\\Users\\asus\\AppData\\Local\\Temp\\RtmpSCcZNG\\downloaded_packages\n```\n:::\n\n\n\n\n然后使用 `BiocManager` 安装 `Rgraphviz` ，需要安装的配套程序包很多，需要几分钟，但是这里出现了报错。\n\n\n\n\n::: {.cell}\n\n```{.bash .cell-code}\n> BiocManager::install(\"Rgraphviz\")\n'getOption(\"repos\")' replaces Bioconductor standard repositories, see\n'help(\"repositories\", package = \"BiocManager\")' for details.\nReplacement repositories:\n    CRAN: https://mirrors.sustech.edu.cn/CRAN\nBioconductor version 3.20 (BiocManager 1.30.25), R 4.4.2 (2024-10-31 ucrt)\nInstalling package(s) 'BiocVersion', 'Rgraphviz'\nalso installing the dependencies 'BiocGenerics', 'graph'\n\ntrying URL 'https://bioconductor.org/packages/3.20/bioc/bin/windows/contrib/4.4/BiocGenerics_0.52.0.zip'\nlibpng warning: iCCP: known incorrect sRGB profile\nlibpng warning: iCCP: known incorrect sRGB profile\nContent type 'application/zip' length 639558 bytes (624 KB)\ndownloaded 624 KB\n\ntrying URL 'https://bioconductor.org/packages/3.20/bioc/bin/windows/contrib/4.4/graph_1.84.1.zip'\nContent type 'application/zip' length 2173761 bytes (2.1 MB)\ndownloaded 2.1 MB\n\ntrying URL 'https://bioconductor.org/packages/3.20/bioc/bin/windows/contrib/4.4/BiocVersion_3.20.0.zip'\nContent type 'application/zip' length 8386 bytes\ndownloaded 8386 bytes\n\ntrying URL 'https://bioconductor.org/packages/3.20/bioc/bin/windows/contrib/4.4/Rgraphviz_2.50.0.zip'\nContent type 'application/zip' length 1457153 bytes (1.4 MB)\ndownloaded 1.4 MB\n\npackage 'BiocGenerics' successfully unpacked and MD5 sums checked\npackage 'graph' successfully unpacked and MD5 sums checked\npackage 'BiocVersion' successfully unpacked and MD5 sums checked\npackage 'Rgraphviz' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n        C:\\Users\\asus\\AppData\\Local\\Temp\\RtmpSCcZNG\\downloaded_packages\nInstallation paths not writeable, unable to update packages\n  path: C:/Program Files/R/R-4.4.2/library\n  packages:\n    class, cli, cluster, curl, data.table, foreign, glue, jsonlite, KernSmooth,\n    lintr, MASS, Matrix, nlme, nnet, processx, ps, purrr, R.utils, R6, renv,\n    reticulate, rlang, rpart, sessioninfo, spatial, survival, tinytex, xfun,\n    xml2, zoo\nOld packages: 'httpgd', 'readxl', 'unigd'\napdate all/some/none? [a/s/n]:\ntrying URL 'https://mirrors.sustech.edu.cn/CRAN/bin/windows/contrib/4.4/httpgd_2.0.3.zip'\nContent type 'application/zip' length 874316 bytes (853 KB)\ndownloaded 853 KB\n\ntrying URL 'https://mirrors.sustech.edu.cn/CRAN/bin/windows/contrib/4.4/readxl_1.4.4.zip' \nContent type 'application/zip' length 750422 bytes (732 KB)\ndownloaded 732 KB\n\ntrying URL 'https://mirrors.sustech.edu.cn/CRAN/bin/windows/contrib/4.4/unigd_0.1.3.zip'\nContent type 'application/zip' length 5591347 bytes (5.3 MB)\ndownloaded 5.3 MB\n\npackage 'httpgd' successfully unpacked and MD5 sums checked\npackage 'readxl' successfully unpacked and MD5 sums checked\nWarning: cannot remove prior installation of package 'readxl'\nWarning: restored 'readxl'\npackage 'unigd' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n        C:\\Users\\asus\\AppData\\Local\\Temp\\RtmpSCcZNG\\downloaded_packages\nWarning message:\nIn file.copy(savedcopy, lib, recursive = TRUE) :\n  problem copying C:\\Users\\asus\\AppData\\Local\\R\\win-library\\4.4\\00LOCK\\readxl\\libs\\x64\\readxl.dll to C:\\Users\\asus\\AppData\\Local\\R\\win-library\\4.4\\readxl\\libs\\x64\\readxl.dll: Permission denied\n```\n:::\n\n\n\n\n主要问题是没有写入权限，这可能和在 vscode 中安装有关，因此，换到 R 的终端中进行安装（注意，可能需要使用管理员权限），但是仍然免不了一系列的包冲突问题，需要根据提示选择操作：\n\n1.  使用管理员身份运行 R 。\n\n2.  选择合适的源来下载。\n\n3.  处理有冲突的包（卸载），或者重新创建一个 env 。\n\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n     # 删除 readxl 包\n     readxl_path <- system.file(package = \"readxl\")\n     if (!is.na(readxl_path)) {\n     unlink(readxl_path, recursive = TRUE)\n     }\n     # 删除 cli 包\n     cli_path <- system.file(package = \"cli\")\n     if (!is.na(cli_path)) {\n     unlink(cli_path, recursive = TRUE)\n     }\n     # 再次尝试安装 Rgraphviz\n     BiocManager::install(\"Rgraphviz\")\n    ```\n    :::\n\n\n\n\n4.  强制更新，忽略冲突\n\n有些包的版本已经是最新的，但安装过程仍然提示需要更新，你可以使用 `force = TRUE` 参数强制重新安装。\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBiocManager::install(\"Rgraphviz\", force = TRUE)\n```\n:::\n\n\n\n\n5.  具体信息如下：\n\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    > BiocManager::install(\"Rgraphviz\")\n    'getOption(\"repos\")' replaces Bioconductor standard repositories, see\n    'help(\"repositories\", package = \"BiocManager\")' for details.\n    Replacement repositories:\n        CRAN: https://mirrors.nju.edu.cn/CRAN\n    Bioconductor version 3.20 (BiocManager 1.30.25), R 4.4.2 (2024-10-31 ucrt)\n    Warning message:\n    package(s) not installed when version(s) same as or greater than current; use\n      `force = TRUE` to re-install: 'Rgraphviz' \n    > BiocManager::install(\"Rgraphviz\", force = TRUE)\n    'getOption(\"repos\")' replaces Bioconductor standard repositories, see\n    'help(\"repositories\", package = \"BiocManager\")' for details.\n    Replacement repositories:\n        CRAN: https://mirrors.nju.edu.cn/CRAN\n    Bioconductor version 3.20 (BiocManager 1.30.25), R 4.4.2 (2024-10-31 ucrt)\n    Installing package(s) 'Rgraphviz'\n    trying URL 'https://bioconductor.org/packages/3.20/bioc/bin/windows/contrib/4.4/Rgraphviz_2.50.0.zip'\n    Content type 'application/zip' length 1457153 bytes (1.4 MB)\n    downloaded 1.4 MB\n    \n    package ‘Rgraphviz’ successfully unpacked and MD5 sums checked\n    \n    The downloaded binary packages are in\n            C:\\Users\\asus\\AppData\\Local\\Temp\\Rtmp2j7SlA\\downloaded_packages\n    ```\n    :::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}